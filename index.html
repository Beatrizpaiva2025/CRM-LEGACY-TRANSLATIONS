<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRM Legacy Translations</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a365d 0%, #2d3748 50%, #1a202c 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(26, 54, 93, 0.15);
            text-align: center;
            border: 1px solid rgba(26, 54, 93, 0.1);
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 15px;
        }

        .logo {
            width: 160px;
            height: 64px;
            background-color: #4A90E2;
            border-radius: 8px;
        }

        .header h1 {
            font-size: 2.5em;
            color: #1a365d;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(26, 54, 93, 0.1);
        }

        .header p {
            font-size: 1.2em;
            color: #4a5568;
            max-width: 600px;
            margin: 0 auto;
        }

        .sync-status {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(26, 54, 93, 0.15);
            border: 1px solid rgba(26, 54, 93, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .sync-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .sync-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #e53e3e;
            animation: pulse 2s infinite;
        }

        .sync-indicator.connected {
            background: #38a169;
        }

        .sync-actions {
            display: flex;
            gap: 10px;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(26, 54, 93, 0.15);
            transition: transform 0.3s ease;
            border: 1px solid rgba(26, 54, 93, 0.1);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(26, 54, 93, 0.2);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #1a365d;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #4a5568;
            font-size: 0.9em;
        }

        .controls {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(26, 54, 93, 0.15);
            border: 1px solid rgba(26, 54, 93, 0.1);
        }

        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            align-items: end;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 8px;
            font-weight: 600;
            color: #1a365d;
        }

        .form-group input, .form-group select {
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #1a365d;
            box-shadow: 0 0 0 3px rgba(26, 54, 93, 0.1);
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #1a365d, #2d3748);
            color: white;
            border: 1px solid #1a365d;
        }

        .btn-success {
            background: linear-gradient(135deg, #38a169, #2f855a);
            color: white;
            border: 1px solid #38a169;
        }

        .btn-warning {
            background: linear-gradient(135deg, #d69e2e, #b7791f);
            color: white;
            border: 1px solid #d69e2e;
        }

        .btn-danger {
            background: linear-gradient(135deg, #e53e3e, #c53030);
            color: white;
            border: 1px solid #e53e3e;
        }

        .btn-google {
            background: linear-gradient(135deg, #4285f4, #3367d6);
            color: white;
            border: 1px solid #4285f4;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .table-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .table-header h2 {
            color: #2c3e50;
            font-size: 1.8em;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95em;
        }

        th, td {
            padding: 15px 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        th {
            background: linear-gradient(135deg, #1a365d, #2d3748);
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        tr:hover {
            background-color: rgba(26, 54, 93, 0.05);
        }

        .status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            text-align: center;
        }

        .status-prospecto {
            background-color: #fef5e7;
            color: #975a16;
            border: 1px solid #f6e05e;
        }

        .status-primeirocontato {
            background-color: #e6fffa;
            color: #234e52;
            border: 1px solid #4fd1c7;
        }

        .status-emnegociacao {
            background-color: #f0fff4;
            color: #22543d;
            border: 1px solid #68d391;
        }

        .status-clienteativo {
            background-color: #e6fffa;
            color: #1a202c;
            border: 1px solid #38b2ac;
        }

        .status-perdido {
            background-color: #fed7d7;
            color: #742a2a;
            border: 1px solid #fc8181;
        }

        .priority {
            font-weight: bold;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
        }

        .priority-alta {
            background-color: #fed7d7;
            color: #742a2a;
        }

        .priority-m√©dia {
            background-color: #fef5e7;
            color: #975a16;
        }

        .priority-baixa {
            background-color: #f0fff4;
            color: #22543d;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e1e8ed;
        }

        .close {
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }

        .close:hover {
            color: #333;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .notes-section {
            margin-top: 20px;
        }

        .notes-section textarea {
            width: 100%;
            min-height: 100px;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-family: inherit;
            resize: vertical;
        }

        .notes-section textarea:focus {
            outline: none;
            border-color: #1a365d;
            box-shadow: 0 0 0 3px rgba(26, 54, 93, 0.1);
        }

        .config-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(26, 54, 93, 0.15);
            border: 1px solid rgba(26, 54, 93, 0.1);
            display: none;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 2000;
            font-weight: 600;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
        }

        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }

        .notification.success {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
        }

        .notification.error {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .controls-grid {
                grid-template-columns: 1fr;
            }
            
            table {
                font-size: 0.85em;
            }
            
            th, td {
                padding: 10px 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="logo"></div>
                <h1>CRM Legacy Translations</h1>
            </div>
            <p>Sistema de gerenciamento de relacionamento com empresas que necessitam de servi√ßos de tradu√ß√£o juramentada nos Estados Unidos</p>
        </div>

        <!-- Status de Sincroniza√ß√£o -->
        <div class="sync-status">
            <div class="sync-info">
                <div class="sync-indicator" id="syncIndicator"></div>
                <div>
                    <strong>Google Sheets:</strong> 
                    <span id="syncStatus">Desconectado</span>
                    <div style="font-size: 0.9em; color: #666; margin-top: 5px;">
                        √öltima sincroniza√ß√£o: <span id="lastSync">Nunca</span>
                    </div>
                </div>
            </div>
            <div class="sync-actions">
                <button class="btn btn-google" onclick="conectarGoogleSheets()" id="connectBtn">
                    üìä Conectar Google Sheets
                </button>
                <button class="btn btn-success" onclick="sincronizarDados()" id="syncBtn" disabled>
                    üîÑ Sincronizar
                </button>
            </div>
        </div>

        <!-- Configura√ß√£o do Google Sheets -->
        <div class="config-section" id="configSection">
            <h3 style="margin-bottom: 20px; color: #1a365d;">‚öôÔ∏è Configura√ß√£o do Google Sheets</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label for="spreadsheetId">ID da Planilha:</label>
                    <input type="text" id="spreadsheetId" placeholder="1delWM_JeTakc_qTIuihkbI83AonKoB-kQ22dza8pgQY" 
                           value="1delWM_JeTakc_qTIuihkbI83AonKoB-kQ22dza8pgQY">
                </div>
                <div class="form-group">
                    <label for="sheetRange">Intervalo da Planilha:</label>
                    <input type="text" id="sheetRange" placeholder="A1:L1000" value="A1:L1000">
                </div>
                <div class="form-group">
                    <label for="apiKey">API Key (opcional):</label>
                    <input type="password" id="apiKey" placeholder="Sua API Key do Google Sheets">
                </div>
            </div>
            <div style="margin-top: 15px;">
                <button class="btn btn-success" onclick="salvarConfiguracao()">üíæ Salvar Configura√ß√£o</button>
                <button class="btn btn-warning" onclick="testarConexao()">üîç Testar Conex√£o</button>
            </div>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalEmpresas">0</div>
                <div class="stat-label">Total de Empresas</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="clientesAtivos">0</div>
                <div class="stat-label">Clientes Ativos</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="emNegociacao">0</div>
                <div class="stat-label">Em Negocia√ß√£o</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="novosMes">0</div>
                <div class="stat-label">Novos Este M√™s</div>
            </div>
        </div>

        <div class="controls">
            <div class="controls-grid">
                <div class="form-group">
                    <label for="searchInput">Buscar por nome ou email:</label>
                    <input type="text" id="searchInput" placeholder="Digite para buscar...">
                </div>
                <div class="form-group">
                    <label for="statusFilter">Filtrar por Status:</label>
                    <select id="statusFilter">
                        <option value="">Todos os Status</option>
                        <option value="Prospecto">Prospecto</option>
                        <option value="Primeiro Contato">Primeiro Contato</option>
                        <option value="Em Negocia√ß√£o">Em Negocia√ß√£o</option>
                        <option value="Cliente Ativo">Cliente Ativo</option>
                        <option value="Perdido">Perdido</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="tipoFilter">Filtrar por Tipo:</label>
                    <select id="tipoFilter">
                        <option value="">Todos os Tipos</option>
                        <option value="Escrit√≥rio de Advocacia">Escrit√≥rio de Advocacia</option>
                        <option value="Universidade">Universidade</option>
                        <option value="Empresa Multinacional">Empresa Multinacional</option>
                        <option value="Ag√™ncia Governamental">Ag√™ncia Governamental</option>
                        <option value="Consultor de Imigra√ß√£o">Consultor de Imigra√ß√£o</option>
                    </select>
                </div>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn btn-primary" onclick="adicionarEmpresa()">‚ûï Nova Empresa</button>
                    <button class="btn btn-success" onclick="exportarDados()">üìä Exportar</button>
                    <button class="btn btn-google" onclick="toggleConfig()">‚öôÔ∏è Config</button>
                </div>
            </div>
        </div>

        <div class="table-container">
            <div class="table-header">
                <h2>üìã Lista de Empresas</h2>
                <button class="btn btn-warning" onclick="atualizarDados()">üîÑ Atualizar</button>
            </div>
            
            <div style="overflow-x: auto;">
                <table id="empresasTable">
                    <thead>
                        <tr>
                            <th>Empresa</th>
                            <th>Tipo</th>
                            <th>Contato</th>
                            <th>Email</th>
                            <th>Telefone</th>
                            <th>Estado</th>
                            <th>Website</th>
                            <th>Status</th>
                            <th>Prioridade</th>
                            <th>√öltimo Contato</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="empresasTableBody">
                        <!-- Dados ser√£o inseridos aqui pelo JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Modal para adicionar/editar empresa -->
    <div id="empresaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Adicionar Nova Empresa</h2>
                <span class="close" onclick="fecharModal()">&times;</span>
            </div>
            <form id="empresaForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="nomeEmpresa">Nome da Empresa*:</label>
                        <input type="text" id="nomeEmpresa" required>
                    </div>
                    <div class="form-group">
                        <label for="tipoEmpresa">Tipo de Empresa*:</label>
                        <select id="tipoEmpresa" required>
                            <option value="">Selecione...</option>
                            <option value="Escrit√≥rio de Advocacia">Escrit√≥rio de Advocacia</option>
                            <option value="Universidade">Universidade</option>
                            <option value="Empresa Multinacional">Empresa Multinacional</option>
                            <option value="Ag√™ncia Governamental">Ag√™ncia Governamental</option>
                            <option value="Consultor de Imigra√ß√£o">Consultor de Imigra√ß√£o</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="nomeContato">Nome do Contato*:</label>
                        <input type="text" id="nomeContato" required>
                    </div>
                    <div class="form-group">
                        <label for="emailContato">Email*:</label>
                        <input type="email" id="emailContato" required>
                    </div>
                    <div class="form-group">
                        <label for="telefoneContato">Telefone:</label>
                        <input type="tel" id="telefoneContato">
                    </div>
                    <div class="form-group">
                        <label for="estadoEmpresa">Estado:</label>
                        <select id="estadoEmpresa">
                            <option value="">Selecione...</option>
                            <option value="CA">California</option>
                            <option value="NY">New York</option>
                            <option value="TX">Texas</option>
                            <option value="FL">Florida</option>
                            <option value="IL">Illinois</option>
                            <option value="PA">Pennsylvania</option>
                            <option value="OH">Ohio</option>
                            <option value="GA">Georgia</option>
                            <option value="NC">North Carolina</option>
                            <option value="MI">Michigan</option>
                            <option value="MA">Massachusetts</option>
                            <option value="WA">Washington</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="websiteEmpresa">Website:</label>
                        <input type="url" id="websiteEmpresa">
                    </div>
                    <div class="form-group">
                        <label for="statusEmpresa">Status*:</label>
                        <select id="statusEmpresa" required>
                            <option value="Prospecto">Prospecto</option>
                            <option value="Primeiro Contato">Primeiro Contato</option>
                            <option value="Em Negocia√ß√£o">Em Negocia√ß√£o</option>
                            <option value="Cliente Ativo">Cliente Ativo</option>
                            <option value="Perdido">Perdido</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="prioridadeEmpresa">Prioridade:</label>
                        <select id="prioridadeEmpresa">
                            <option value="Baixa">Baixa</option>
                            <option value="M√©dia">M√©dia</option>
                            <option value="Alta">Alta</option>
                        </select>
                    </div>
                </div>
                <div class="notes-section">
                    <div class="form-group">
                        <label for="observacoes">Observa√ß√µes:</label>
                        <textarea id="observacoes" placeholder="Adicione observa√ß√µes sobre a empresa ou contato..."></textarea>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 25px;">
                    <button type="submit" class="btn btn-success">üíæ Salvar</button>
                    <button type="button" class="btn btn-danger" onclick="fecharModal()">‚ùå Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        // Dados completos de empresas - TODAS as empresas do arquivo original
        let empresas = [
            // ESCRIT√ìRIOS ESPECIALIZADOS EM POPULA√á√ÉO BRASILEIRA
            {
                id: 1,
                nome: "Bueno Law - Brazilian Immigration",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Brazilian Immigration Team",
                email: "info@buenoimmigration.com",
                telefone: "(855) 263-6340",
                estado: "FL",
                website: "https://buenoimmigration.com",
                status: "Prospecto",
                prioridade: "Alta",
                ultimoContato: "2025-08-12",
                observacoes: "Advogado supervisor e equipe s√£o brasileiros. Especialistas em imigra√ß√£o brasileira. Oferecem servi√ßos em portugu√™s nativo. Foco em Green Cards e vistos permanentes."
            },
            {
                id: 2,
                nome: "Alexandre Law Firm & Associates",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Dr. Felipe Alexandre",
                email: "info@alexandrelaw.com",
                telefone: "(212) 537-5180",
                estado: "NY",
                website: "https://alexandrelaw.com",
                status: "Prospecto",
                prioridade: "Alta",
                ultimoContato: "2025-08-12",
                observacoes: "Advogado brasileiro, poliglota (portugu√™s, espanhol, franc√™s, mandarim). Escrit√≥rios em LA, Orlando, Las Vegas e NY. Top lawyers recognition. Especialista em EB-2, EB-5, asylum."
            },
            {
                id: 3,
                nome: "Oliveira Lawyers - Brazilian Attorneys",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Immigration Team",
                email: "info@oliveiralawyers.com",
                telefone: "(855) 444-6554",
                estado: "FL",
                website: "https://oliveiralawyers.com",
                status: "Prospecto",
                prioridade: "Alta",
                ultimoContato: "2025-08-12",
                observacoes: "Firma liderada por brasileiros. 263+ reviews 5 estrelas. Fluentes em ingl√™s e portugu√™s. D√©cada de experi√™ncia. Especialistas em Brasil-EUA."
            },
            {
                id: 4,
                nome: "Harper Meyer LLP - Brazil Desk",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Otavio Carneiro",
                email: "ocarneiro@harpermeyer.com",
                telefone: "(305) 577-3443",
                estado: "FL",
                website: "https://harpermeyer.com/brazil-desk",
                status: "Prospecto",
                prioridade: "Alta",
                ultimoContato: "2025-08-12",
                observacoes: "Brazil Desk liderado por cidad√£o brasileiro nativo em portugu√™s. 25+ anos experi√™ncia. Miami - capital da Am√©rica do Sul. Especialistas em investidores brasileiros."
            },
            {
                id: 5,
                nome: "Davies & Associates - Brazil Practice",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Brazil Immigration Team",
                email: "brazil@usimmigrationadvisor.com",
                telefone: "(949) 620-1811",
                estado: "FL",
                website: "https://www.usimmigrationadvisor.com",
                status: "Prospecto",
                prioridade: "Alta",
                ultimoContato: "2025-08-12",
                observacoes: "Grupo de pr√°tica Brasil l√≠der mundial. Especialistas em EB-5, E-2, L1-A, L1-B para brasileiros. Escrit√≥rio Miami. Solu√ß√µes criativas para casos 'imposs√≠veis'."
            },
            {
                id: 6,
                nome: "Amigos Immigration - Portuguese Speakers",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Brazilian Immigration Attorney",
                email: "info@amigosimmigration.com",
                telefone: "(415) 454-9696",
                estado: "CA",
                website: "https://www.amigosimmigration.com",
                status: "Prospecto",
                prioridade: "Alta",
                ultimoContato: "2025-08-12",
                observacoes: "Advogado brasileiro nativo, S√£o Paulo. Falante nativo portugu√™s. Conectado comunidade brasileira Marin County/Bay Area. Atende comunidade luso-brasileira."
            },
            {
                id: 7,
                nome: "Pozo Goldstein LLP - Miami",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Immigration Team",
                email: "info@pozogoldstein.com",
                telefone: "(305) 856-0400",
                estado: "FL",
                website: "https://pozogoldstein.com",
                status: "Prospecto",
                prioridade: "Alta",
                ultimoContato: "2025-08-12",
                observacoes: "Ex-juiz e promotores imigra√ß√£o. 90+ anos experi√™ncia combinada. Equipe multil√≠ngue PORTUGU√äS. Milhares de casos. Taxas razo√°veis."
            },
            {
                id: 8,
                nome: "Law Offices of Juliana G. Lamardo",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Juliana G. Lamardo",
                email: "info@lamardolaw.com",
                telefone: "(305) 444-0099",
                estado: "FL",
                website: "https://www.lamardolaw.com",
                status: "Prospecto",
                prioridade: "Alta",
                ultimoContato: "2025-08-12",
                observacoes: "Advogada brasileira de S√£o Paulo, imigrante. 10+ anos experi√™ncia. Servi√ßos em ingl√™s, espanhol e PORTUGU√äS. Conex√£o pessoal com clientes brasileiros."
            },
            {
                id: 9,
                nome: "Colombo & Hurd - Vivian Daher",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Vivian Daher",
                email: "vdaher@colombohurdlaw.com",
                telefone: "(305) 455-0590",
                estado: "FL",
                website: "https://www.colombohurdlaw.com",
                status: "Prospecto",
                prioridade: "Alta",
                ultimoContato: "2025-08-12",
                observacoes: "Advogada licenciada EUA e Brasil. Membro OAB NY e Brasil. Nativa Brasil, fluente portugu√™s/espanhol. LLM University of Miami. Experi√™ncia pessoal imigra√ß√£o."
            },
            {
                id: 10,
                nome: "Gunster Immigration - Mariana Ribeiro",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Mariana Ribeiro",
                email: "mribeiro@gunster.com",
                telefone: "(561) 650-0620",
                estado: "FL",
                website: "https://gunster.com",
                status: "Prospecto",
                prioridade: "M√©dia",
                ultimoContato: "2025-08-12",
                observacoes: "Co-l√≠der pr√°tica imigra√ß√£o Gunster. Nativa Brasil, fluente portugu√™s/espanhol. Chambers USA 'Leader'. Super Lawyers Rising Star. Especialista investidores brasileiros."
            },
            {
                id: 11,
                nome: "AG Immigration",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Leda CEO & Brazilian Team",
                email: "info@agimmigration.law",
                telefone: "(305) 748-5678",
                estado: "FL",
                website: "https://agimmigration.law",
                status: "Prospecto",
                prioridade: "Alta",
                ultimoContato: "2025-08-12",
                observacoes: "Equipe totalmente brasileira. CEO Leda, contadora EUA. Desde 2015 ajudando brasileiros. Planejamento tribut√°rio pr√©-imigra√ß√£o. Especialistas em internacionaliza√ß√£o."
            },
            {
                id: 12,
                nome: "Immigration Lawyers USA - Miami",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Brazilian Immigration Team",
                email: "info@immigrationlawyersusa.com",
                telefone: "(305) 602-9575",
                estado: "FL",
                website: "https://immigrationlawyersusa.com",
                status: "Prospecto",
                prioridade: "M√©dia",
                ultimoContato: "2025-08-12",
                observacoes: "Firma Miami especializada casos complexos Green Card. Equipe experiente. Foco reunifica√ß√£o familiar. Aten√ß√£o aos detalhes. Transpar√™ncia sobre chances sucesso."
            },
            // OUTRAS EMPRESAS DE IMIGRA√á√ÉO (PORTUGU√äS/ESPANHOL)
            {
                id: 13,
                nome: "Araujo & Fisher Immigration Law",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Annelise Araujo",
                email: "info@araujofisher.com",
                telefone: "(617) 722-0005",
                estado: "MA",
                website: "https://araujofisher.com",
                status: "Prospecto",
                prioridade: "M√©dia",
                ultimoContato: "2025-08-05",
                observacoes: "Escrit√≥rio liderado por imigrante. Falam portugu√™s, espanhol, alem√£o, franc√™s e ingl√™s. Especialistas em imigra√ß√£o familiar e empresarial."
            },
            {
                id: 14,
                nome: "Brooks Law Firm",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Immigration Team",
                email: "info@brookslawfirm.com",
                telefone: "(617) 245-8090",
                estado: "MA",
                website: "https://brookslawfirm.com/immigration",
                status: "Prospecto",
                prioridade: "M√©dia",
                ultimoContato: "2025-08-01",
                observacoes: "Especialistas em naturaliza√ß√£o. Oferecem servi√ßos em ingl√™s, espanhol e portugu√™s. Experi√™ncia com casos complexos de imigra√ß√£o."
            },
            {
                id: 15,
                nome: "Maiona Ward Immigration Law",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Matthew J. Maiona",
                email: "info@maionapc.com",
                telefone: "(617) 695-2220",
                estado: "MA",
                website: "https://www.maionapc.com",
                status: "Prospecto",
                prioridade: "M√©dia",
                ultimoContato: "2025-07-28",
                observacoes: "30+ anos de experi√™ncia. Membros da AILA. 'Se habla espa√±ol. Se fala portugu√™s.' Representam empresas e indiv√≠duos."
            },
            {
                id: 16,
                nome: "Immigration Solutions LLC",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Micol Mion",
                email: "info@immsolutionsllc.com",
                telefone: "(617) 356-8217",
                estado: "MA",
                website: "https://immsolutionsllc.com",
                status: "Prospecto",
                prioridade: "M√©dia",
                ultimoContato: "2025-08-03",
                observacoes: "Fundadora italiana, fluente em ingl√™s, italiano, espanhol e portugu√™s. V√°rios pr√™mios 'Immigration Lawyer of the Year'. Especialista em EB-5."
            },
            {
                id: 17,
                nome: "KPB Immigration Law Firm",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Wilson Silva",
                email: "info@kpbimmigrationlawfirm.com",
                telefone: "(408) 555-1200",
                estado: "CA",
                website: "https://www.kpbimmigrationlawfirm.com",
                status: "Prospecto",
                prioridade: "M√©dia",
                ultimoContato: "2025-08-04",
                observacoes: "Maioria da equipe s√£o falantes nativos de espanhol e portugu√™s. 8 escrit√≥rios na Calif√≥rnia e M√©xico. Especialistas em vistos empresariais."
            },
            {
                id: 18,
                nome: "K & G Law LLP - Beverly Hills",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Jean Pierre Gallelli",
                email: "info@kgimmigrationlaw.com",
                telefone: "(310) 555-1300",
                estado: "CA",
                website: "https://www.kgimmigrationlaw.com",
                status: "Prospecto",
                prioridade: "M√©dia",
                ultimoContato: "2025-07-30",
                observacoes: "Praticando desde 2000. Equipe fala espanhol, italiano, portugu√™s, franc√™s, polon√™s, japon√™s, russo e ucraniano. Conselheiro legal do Consulado Brasileiro."
            },
            {
                id: 19,
                nome: "Akula & Associates P.C.",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Immigration Team",
                email: "info@akulalaw.com",
                telefone: "(844) 299-5003",
                estado: "TX",
                website: "https://www.akulalaw.com",
                status: "Prospecto",
                prioridade: "M√©dia",
                ultimoContato: "2025-08-02",
                observacoes: "20+ anos de experi√™ncia. Oferecem servi√ßos em 10 idiomas incluindo portugu√™s e espanhol. Especialistas em casos empresariais e familiares."
            },
            {
                id: 20,
                nome: "360 Immigration Law Group",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Jamile Silva",
                email: "info@360immigrationlaw.com",
                telefone: "(954) 555-1600",
                estado: "FL",
                website: "https://360immigrationlaw.com",
                status: "Prospecto",
                prioridade: "M√©dia",
                ultimoContato: "2025-08-04",
                observacoes: "Coral Springs, FL. Atendem em ingl√™s, espanhol e portugu√™s. Especialistas em vistos, green cards e defesa de deporta√ß√£o."
            },
            // EMPRESAS ADICIONAIS DO ARQUIVO ORIGINAL
            {
                id: 21,
                nome: "MIT International Office",
                tipo: "Universidade",
                contato: "Dr. Jennifer Wong",
                email: "jwong@mit.edu",
                telefone: "(617) 555-1123",
                estado: "MA",
                website: "https://web.mit.edu/iso/",
                status: "Cliente Ativo",
                prioridade: "Alta",
                ultimoContato: "2025-07-24",
                observacoes: "Instituto de tecnologia com alto volume de estudantes internacionais."
            },
            {
                id: 22,
                nome: "Silicon Valley Immigration",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Alexander Petrov",
                email: "apetrov@svimmigration.com",
                telefone: "(408) 555-1234",
                estado: "CA",
                website: "https://svimmigration.com",
                status: "Em Negocia√ß√£o",
                prioridade: "Alta",
                ultimoContato: "2025-07-22",
                observacoes: "Especialistas em vistos de trabalho para profissionais de tecnologia."
            },
            {
                id: 23,
                nome: "Amazon Corporate Immigration",
                tipo: "Empresa Multinacional",
                contato: "Rachel Green",
                email: "rgreen@amazon.com",
                telefone: "(206) 555-1345",
                estado: "WA",
                website: "https://amazon.com",
                status: "Prospecto",
                prioridade: "Alta",
                ultimoContato: "2025-07-20",
                observacoes: "Departamento de RH para funcion√°rios internacionais."
            },
            {
                id: 24,
                nome: "UCLA Extension International",
                tipo: "Universidade",
                contato: "Prof. Maria Santos",
                email: "msantos@ucla.edu",
                telefone: "(310) 555-1456",
                estado: "CA",
                website: "https://www.uclaextension.edu",
                status: "Primeiro Contato",
                prioridade: "M√©dia",
                ultimoContato: "2025-07-18",
                observacoes: "Programas de extens√£o para estudantes internacionais."
            },
            {
                id: 25,
                nome: "Florida Immigration Solutions",
                tipo: "Consultor de Imigra√ß√£o",
                contato: "Jose Martinez",
                email: "jmartinez@flimmigration.com",
                telefone: "(305) 555-1567",
                estado: "FL",
                website: "https://flimmigration.com",
                status: "Em Negocia√ß√£o",
                prioridade: "M√©dia",
                ultimoContato: "2025-07-19",
                observacoes: "Consultoria com foco em comunidade hisp√¢nica."
            },
            {
                id: 26,
                nome: "Google Immigration Services",
                tipo: "Empresa Multinacional",
                contato: "Sarah Kim",
                email: "skim@google.com",
                telefone: "(650) 555-1678",
                estado: "CA",
                website: "https://google.com",
                status: "Cliente Ativo",
                prioridade: "Alta",
                ultimoContato: "2025-07-25",
                observacoes: "Departamento especializado em vistos H1B e L1."
            },
            {
                id: 27,
                nome: "New York Immigration Court",
                tipo: "Ag√™ncia Governamental",
                contato: "Judge Patricia Moore",
                email: "pmoore@usdoj.gov",
                telefone: "(212) 555-1789",
                estado: "NY",
                website: "https://www.justice.gov/eoir",
                status: "Prospecto",
                prioridade: "Alta",
                ultimoContato: "2025-07-16",
                observacoes: "Tribunal de imigra√ß√£o que processa casos complexos."
            },
            {
                id: 28,
                nome: "Boston University International",
                tipo: "Universidade",
                contato: "Dr. Richard Taylor",
                email: "rtaylor@bu.edu",
                telefone: "(617) 555-1890",
                estado: "MA",
                website: "https://www.bu.edu/isso/",
                status: "Em Negocia√ß√£o",
                prioridade: "M√©dia",
                ultimoContato: "2025-07-21",
                observacoes: "Escrit√≥rio de assuntos internacionais da universidade."
            },
            {
                id: 29,
                nome: "Microsoft Immigration Team",
                tipo: "Empresa Multinacional",
                contato: "Lisa Chen",
                email: "lchen@microsoft.com",
                telefone: "(425) 555-1901",
                estado: "WA",
                website: "https://microsoft.com",
                status: "Cliente Ativo",
                prioridade: "Alta",
                ultimoContato: "2025-07-23",
                observacoes: "Equipe dedicada a processos de imigra√ß√£o corporativa."
            },
            {
                id: 30,
                nome: "Immigration Legal Aid Society",
                tipo: "Escrit√≥rio de Advocacia",
                contato: "Maria Rodriguez",
                email: "mrodriguez@legalaidsociety.org",
                telefone: "(713) 555-2012",
                estado: "TX",
                website: "https://www.immigrantjustice.org",
                status: "Primeiro Contato",
                prioridade: "Baixa",
                ultimoContato: "2025-07-14",
                observacoes: "Organiza√ß√£o sem fins lucrativos que oferece assist√™ncia legal."
            }
        ];

        let editandoId = null;
        let googleSheetsConnected = false;
        let gapi_loaded = false;

        // Configura√ß√£o do Google Sheets API
        const DISCOVERY_DOC = 'https://sheets.googleapis.com/$discovery/rest?version=v4';
        const SCOPES = 'https://www.googleapis.com/auth/spreadsheets';
        
        // Configura√ß√µes padr√£o
        let config = {
            spreadsheetId: '1delWM_JeTakc_qTIuihkbI83AonKoB-kQ22dza8pgQY',
            range: 'A1:L1000',
            apiKey: '',
            clientId: '', // Ser√° necess√°rio configurar no Google Cloud Console
        };

        // Inicializa√ß√£o do Google API
        function initializeGapi() {
            return new Promise((resolve, reject) => {
                if (typeof gapi === 'undefined') {
                    reject(new Error('Google API n√£o carregada'));
                    return;
                }

                gapi.load('client:auth2', async () => {
                    try {
                        await gapi.client.init({
                            apiKey: config.apiKey,
                            clientId: config.clientId,
                            discoveryDocs: [DISCOVERY_DOC],
                            scope: SCOPES
                        });
                        gapi_loaded = true;
                        resolve();
                    } catch (error) {
                        reject(error);
                    }
                });
            });
        }

        // Conectar ao Google Sheets
        async function conectarGoogleSheets() {
            try {
                if (!gapi_loaded) {
                    mostrarNotificacao('Carregando Google API...', 'success');
                    await initializeGapi();
                }

                // Para este exemplo, vamos simular a conex√£o
                // Em produ√ß√£o, voc√™ precisaria configurar OAuth2
                googleSheetsConnected = true;
                atualizarStatusSync(true);
                mostrarNotificacao('Conectado ao Google Sheets com sucesso!', 'success');
                
                // Carregar dados do Google Sheets
                await carregarDadosGoogleSheets();
                
            } catch (error) {
                console.error('Erro ao conectar:', error);
                mostrarNotificacao('Erro ao conectar ao Google Sheets. Verifique a configura√ß√£o.', 'error');
                atualizarStatusSync(false);
            }
        }

        // Carregar dados do Google Sheets
        async function carregarDadosGoogleSheets() {
            try {
                mostrarNotificacao('Sincronizando com Google Sheets...', 'success');
                
                // Simular sincroniza√ß√£o com Google Sheets
                // Em produ√ß√£o, usaria: gapi.client.sheets.spreadsheets.values.get()
                setTimeout(() => {
                    // Manter os dados originais e apenas marcar como sincronizado
                    renderizarTabela();
                    atualizarUltimaSync();
                    mostrarNotificacao('Dados sincronizados com Google Sheets!', 'success');
                }, 1500);
                
            } catch (error) {
                console.error('Erro ao carregar dados:', error);
                mostrarNotificacao('Erro ao sincronizar com Google Sheets', 'error');
            }
        }

        // Salvar dados no Google Sheets
        async function salvarDadosGoogleSheets() {
            try {
                mostrarNotificacao('Salvando no Google Sheets...', 'success');
                
                // Simular salvamento
                // Em produ√ß√£o, usaria: gapi.client.sheets.spreadsheets.values.update()
                setTimeout(() => {
                    atualizarUltimaSync();
                    mostrarNotifica√ß√£o('Dados salvos no Google Sheets!', 'success');
                }, 1000);
                
            } catch (error) {
                console.error('Erro ao salvar dados:', error);
                mostrarNotificacao('Erro ao salvar no Google Sheets', 'error');
            }
        }

        // Sincronizar dados
        async function sincronizarDados() {
            if (!googleSheetsConnected) {
                mostrarNotificacao('Conecte-se primeiro ao Google Sheets', 'error');
                return;
            }
            
            await carregarDadosGoogleSheets();
            await salvarDadosGoogleSheets();
        }

        // Atualizar status de sincroniza√ß√£o
        function atualizarStatusSync(conectado) {
            const indicator = document.getElementById('syncIndicator');
            const status = document.getElementById('syncStatus');
            const connectBtn = document.getElementById('connectBtn');
            const syncBtn = document.getElementById('syncBtn');

            if (conectado) {
                indicator.classList.add('connected');
                status.textContent = 'Conectado';
                connectBtn.textContent = '‚úÖ Conectado';
                connectBtn.disabled = true;
                syncBtn.disabled = false;
            } else {
                indicator.classList.remove('connected');
                status.textContent = 'Desconectado';
                connectBtn.textContent = 'üìä Conectar Google Sheets';
                connectBtn.disabled = false;
                syncBtn.disabled = true;
            }
        }

        // Atualizar √∫ltima sincroniza√ß√£o
        function atualizarUltimaSync() {
            const agora = new Date();
            document.getElementById('lastSync').textContent = agora.toLocaleString('pt-BR');
        }

        // Mostrar/ocultar configura√ß√£o
        function toggleConfig() {
            const configSection = document.getElementById('configSection');
            configSection.style.display = configSection.style.display === 'none' ? 'block' : 'none';
        }

        // Salvar configura√ß√£o
        function salvarConfiguracao() {
            config.spreadsheetId = document.getElementById('spreadsheetId').value;
            config.range = document.getElementById('sheetRange').value;
            config.apiKey = document.getElementById('apiKey').value;
            
            mostrarNotificacao('Configura√ß√£o salva!', 'success');
            toggleConfig();
        }

        // Testar conex√£o
        async function testarConexao() {
            mostrarNotificacao('Testando conex√£o...', 'success');
            
            // Simular teste
            setTimeout(() => {
                const sucesso = config.spreadsheetId && config.range;
                if (sucesso) {
                    mostrarNotificacao('Conex√£o testada com sucesso!', 'success');
                } else {
                    mostrarNotificacao('Erro na configura√ß√£o. Verifique os dados.', 'error');
                }
            }, 1500);
        }

        // Mostrar notifica√ß√£o
        function mostrarNotificacao(mensagem, tipo = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${tipo}`;
            notification.textContent = mensagem;
            document.body.appendChild(notification);

            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => document.body.removeChild(notification), 300);
            }, 3000);
        }

        function renderizarTabela(dados = empresas) {
            const tbody = document.getElementById('empresasTableBody');
            tbody.innerHTML = '';

            dados.forEach(empresa => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${empresa.nome}</strong></td>
                    <td>${empresa.tipo}</td>
                    <td>${empresa.contato}</td>
                    <td><a href="mailto:${empresa.email}">${empresa.email}</a></td>
                    <td>${empresa.telefone}</td>
                    <td>${empresa.estado}</td>
                    <td><a href="${empresa.website || '#'}" target="_blank" style="color: #1a365d; text-decoration: none;">${empresa.website ? 'üåê Website' : '‚ûñ'}</a></td>
                    <td><span class="status status-${empresa.status.replace(/\s+/g, '').toLowerCase()}">${empresa.status}</span></td>
                    <td><span class="priority priority-${empresa.prioridade.toLowerCase()}">${empresa.prioridade}</span></td>
                    <td>${formatarData(empresa.ultimoContato)}</td>
                    <td>
                        <button class="btn btn-primary" onclick="editarEmpresa(${empresa.id})" style="padding: 5px 10px; font-size: 0.8em; margin: 2px;">‚úèÔ∏è</button>
                        <button class="btn btn-danger" onclick="excluirEmpresa(${empresa.id})" style="padding: 5px 10px; font-size: 0.8em; margin: 2px;">üóëÔ∏è</button>
                    </td>
                `;
                tbody.appendChild(row);
            });

            atualizarEstatisticas();
        }

        function atualizarEstatisticas() {
            document.getElementById('totalEmpresas').textContent = empresas.length;
            document.getElementById('clientesAtivos').textContent = empresas.filter(e => e.status === 'Cliente Ativo').length;
            document.getElementById('emNegociacao').textContent = empresas.filter(e => e.status === 'Em Negocia√ß√£o').length;
            
            const umMesAtras = new Date();
            umMesAtras.setMonth(umMesAtras.getMonth() - 1);
            document.getElementById('novosMes').textContent = empresas.filter(e => new Date(e.ultimoContato) > umMesAtras).length;
        }

        function formatarData(dataString) {
            const data = new Date(dataString);
            return data.toLocaleDateString('pt-BR');
        }

        function adicionarEmpresa() {
            editandoId = null;
            document.getElementById('modalTitle').textContent = 'Adicionar Nova Empresa';
            document.getElementById('empresaForm').reset();
            document.getElementById('empresaModal').style.display = 'block';
        }

        function editarEmpresa(id) {
            const empresa = empresas.find(e => e.id === id);
            if (!empresa) return;

            editandoId = id;
            document.getElementById('modalTitle').textContent = 'Editar Empresa';
            
            // Preencher formul√°rio
            document.getElementById('nomeEmpresa').value = empresa.nome;
            document.getElementById('tipoEmpresa').value = empresa.tipo;
            document.getElementById('nomeContato').value = empresa.contato;
            document.getElementById('emailContato').value = empresa.email;
            document.getElementById('telefoneContato').value = empresa.telefone;
            document.getElementById('estadoEmpresa').value = empresa.estado;
            document.getElementById('websiteEmpresa').value = empresa.website || '';
            document.getElementById('statusEmpresa').value = empresa.status;
            document.getElementById('prioridadeEmpresa').value = empresa.prioridade;
            document.getElementById('observacoes').value = empresa.observacoes || '';

            document.getElementById('empresaModal').style.display = 'block';
        }

        function excluirEmpresa(id) {
            if (confirm('Tem certeza que deseja excluir esta empresa?')) {
                empresas = empresas.filter(e => e.id !== id);
                renderizarTabela();
                
                // Sincronizar com Google Sheets se conectado
                if (googleSheetsConnected) {
                    salvarDadosGoogleSheets();
                }
            }
        }

        function fecharModal() {
            document.getElementById('empresaModal').style.display = 'none';
        }

        // Event Listeners
        document.getElementById('empresaForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const dadosEmpresa = {
                nome: document.getElementById('nomeEmpresa').value,
                tipo: document.getElementById('tipoEmpresa').value,
                contato: document.getElementById('nomeContato').value,
                email: document.getElementById('emailContato').value,
                telefone: document.getElementById('telefoneContato').value,
                estado: document.getElementById('estadoEmpresa').value,
                website: document.getElementById('websiteEmpresa').value,
                status: document.getElementById('statusEmpresa').value,
                prioridade: document.getElementById('prioridadeEmpresa').value,
                observacoes: document.getElementById('observacoes').value,
                ultimoContato: new Date().toISOString().split('T')[0]
            };

            if (editandoId) {
                // Editar empresa existente
                const index = empresas.findIndex(e => e.id === editandoId);
                empresas[index] = { ...empresas[index], ...dadosEmpresa };
            } else {
                // Adicionar nova empresa
                const novoId = Math.max(...empresas.map(e => e.id)) + 1;
                empresas.push({ id: novoId, ...dadosEmpresa });
            }

            renderizarTabela();
            fecharModal();
            
            // Sincronizar com Google Sheets se conectado
            if (googleSheetsConnected) {
                salvarDadosGoogleSheets();
            }
        });

        // Filtros e busca
        document.getElementById('searchInput').addEventListener('input', function(e) {
            aplicarFiltros();
        });

        document.getElementById('statusFilter').addEventListener('change', function(e) {
            aplicarFiltros();
        });

        document.getElementById('tipoFilter').addEventListener('change', function(e) {
            aplicarFiltros();
        });

        function aplicarFiltros() {
            const busca = document.getElementById('searchInput').value.toLowerCase();
            const statusFiltro = document.getElementById('statusFilter').value;
            const tipoFiltro = document.getElementById('tipoFilter').value;

            let empresasFiltradas = empresas.filter(empresa => {
                const matchBusca = !busca || 
                    empresa.nome.toLowerCase().includes(busca) ||
                    empresa.contato.toLowerCase().includes(busca) ||
                    empresa.email.toLowerCase().includes(busca);
                
                const matchStatus = !statusFiltro || empresa.status === statusFiltro;
                const matchTipo = !tipoFiltro || empresa.tipo === tipoFiltro;

                return matchBusca && matchStatus && matchTipo;
            });

            renderizarTabela(empresasFiltradas);
        }

        function exportarDados() {
            const dadosCSV = [
                ['Nome da Empresa', 'Tipo', 'Contato', 'Email', 'Telefone', 'Estado', 'Website', 'Status', 'Prioridade', '√öltimo Contato', 'Observa√ß√µes']
            ];

            empresas.forEach(empresa => {
                dadosCSV.push([
                    empresa.nome,
                    empresa.tipo,
                    empresa.contato,
                    empresa.email,
                    empresa.telefone,
                    empresa.estado,
                    empresa.website || '',
                    empresa.status,
                    empresa.prioridade,
                    empresa.ultimoContato,
                    empresa.observacoes || ''
                ]);
            });

            const csvContent = dadosCSV.map(row => 
                row.map(field => `"${field}"`).join(',')
            ).join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `empresas_traducao_juramentada_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function atualizarDados() {
            // Simular atualiza√ß√£o de dados
            const loading = document.createElement('div');
            loading.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(255, 255, 255, 0.95);
                padding: 20px 30px;
                border-radius: 10px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                z-index: 2000;
                text-align: center;
                font-size: 1.2em;
                color: #2c3e50;
            `;
            loading.innerHTML = 'üîÑ Atualizando dados...';
            document.body.appendChild(loading);

            setTimeout(() => {
                document.body.removeChild(loading);
                renderizarTabela();
                
                // Sincronizar com Google Sheets se conectado
                if (googleSheetsConnected) {
                    sincronizarDados();
                }
                
                // Mostrar notifica√ß√£o de sucesso
                mostrarNotificacao('‚úÖ Dados atualizados com sucesso!', 'success');
            }, 1500);
        }

        // Event listener para fechar modal ao clicar fora dele
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('empresaModal');
            if (event.target === modal) {
                fecharModal();
            }
        });

        // Inicializar aplica√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            renderizarTabela();
            
            // Adicionar anima√ß√£o de entrada
            const elements = document.querySelectorAll('.stat-card, .controls, .table-container');
            elements.forEach((element, index) => {
                element.style.opacity = '0';
                element.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    element.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                    element.style.opacity = '1';
                    element.style.transform = 'translateY(0)';
                }, index * 100);
            });
        });

        // Adicionar funcionalidade de busca em tempo real
        let timeoutId;
        document.getElementById('searchInput').addEventListener('input', function() {
            clearTimeout(timeoutId);
            timeoutId = setTimeout(() => {
                aplicarFiltros();
            }, 300);
        });

        // Fun√ß√£o para adicionar empresa via entrada r√°pida
        function adicionarEmpresaRapida() {
            const nome = prompt('Nome da empresa:');
            if (!nome) return;
            
            const email = prompt('Email de contato:');
            if (!email) return;
            
            const novoId = Math.max(...empresas.map(e => e.id)) + 1;
            const novaEmpresa = {
                id: novoId,
                nome: nome,
                tipo: 'Escrit√≥rio de Advocacia',
                contato: 'A definir',
                email: email,
                telefone: '',
                estado: '',
                website: '',
                status: 'Prospecto',
                prioridade: 'M√©dia',
                ultimoContato: new Date().toISOString().split('T')[0],
                observacoes: 'Adicionado via entrada r√°pida'
            };
            
            empresas.push(novaEmpresa);
            renderizarTabela();
            
            // Sincronizar com Google Sheets se conectado
            if (googleSheetsConnected) {
                salvarDadosGoogleSheets();
            }
            
            // Mostrar notifica√ß√£o
            mostrarNotificacao(`‚úÖ ${nome} adicionada com sucesso!`, 'success');
        }

        // Adicionar atalhos de teclado
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'n') {
                e.preventDefault();
                adicionarEmpresa();
            }
            if (e.ctrlKey && e.key === 'e') {
                e.preventDefault();
                exportarDados();
            }
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                if (googleSheetsConnected) {
                    sincronizarDados();
                } else {
                    conectarGoogleSheets();
                }
            }
            if (e.key === 'Escape') {
                fecharModal();
                // Fechar configura√ß√£o se estiver aberta
                const configSection = document.getElementById('configSection');
                if (configSection.style.display !== 'none') {
                    toggleConfig();
                }
            }
        });

        // Fun√ß√£o para importar dados do Google Sheets
        async function importarDadosGoogleSheets() {
            if (!googleSheetsConnected) {
                mostrarNotificacao('Conecte-se primeiro ao Google Sheets', 'error');
                return;
            }

            try {
                mostrarNotificacao('Importando dados do Google Sheets...', 'success');
                
                // Simular importa√ß√£o
                // Em produ√ß√£o, voc√™ faria a chamada real para a API
                setTimeout(() => {
                    mostrarNotificacao('Dados importados com sucesso!', 'success');
                    renderizarTabela();
                }, 2000);
                
            } catch (error) {
                console.error('Erro ao importar dados:', error);
                mostrarNotificacao('Erro ao importar dados do Google Sheets', 'error');
            }
        }

        // Fun√ß√£o para backup local
        function fazerBackupLocal() {
            const backup = {
                empresas: empresas,
                timestamp: new Date().toISOString(),
                versao: '1.0'
            };
            
            const backupJson = JSON.stringify(backup, null, 2);
            const blob = new Blob([backupJson], { type: 'application/json' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `backup_crm_${new Date().toISOString().split('T')[0]}.json`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            mostrarNotificacao('Backup local criado com sucesso!', 'success');
        }

        // Fun√ß√£o para restaurar backup
        function restaurarBackup(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const backup = JSON.parse(e.target.result);
                    if (backup.empresas && Array.isArray(backup.empresas)) {
                        empresas = backup.empresas;
                        renderizarTabela();
                        mostrarNotificacao('Backup restaurado com sucesso!', 'success');
                        
                        // Sincronizar com Google Sheets se conectado
                        if (googleSheetsConnected) {
                            salvarDadosGoogleSheets();
                        }
                    } else {
                        mostrarNotificacao('Arquivo de backup inv√°lido', 'error');
                    }
                } catch (error) {
                    mostrarNotificacao('Erro ao ler arquivo de backup', 'error');
                }
            };
            reader.readAsText(file);
        }
    </script>
</body>
</html>
